<!DOCTYPE html>
<html lang="en">
	<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>d3-composite-projections</title>
    <link href='//fonts.googleapis.com/css?family=Lato:300,300italic|Inconsolata' rel='stylesheet' type='text/css'>
    <style>
  html {
      border-top: 5px solid #89b889;
      border-bottom: 5px solid #719871;
        }

  body {
  color: #343434;
  font-family: "Lato", sans-serif;

      background: #eee;
  }
	a {
		color: #030;
	}
  h1 {
  text-align: center;
  font-size: 80px;
  font-weight: 300;
  margin: 0;
}

h2 {
  font-size: 22px;
  text-align: center;
  font-style: italic;
  font-weight: 300;
  padding: 1em;
  margin: 0;
}

h3 {
  font-size: 18px;
  text-align: center;
  font-style: italic;
  font-weight: 300;
  padding: 1em;
  margin: 0;
}
.github {
    margin: auto;
    margin-bottom: 2em;
    max-width: 120px;
}
.svg-section {
               /*opacity: 0;*/
               margin: auto;
               margin-top: 0;
               margin-bottom: 2em;
               max-width: 660px;
               min-height: 400px;
            }
#france_example {
  width: 100%;
}
.light-section {
  background: #89b889;
text-align: center;
padding-bottom: 2em;
}

.darker-section {
  background: #81ae81;
text-align: center;
padding-bottom: 2em;
}

.white-section {
text-align: center;
padding-bottom: 2em;
}

code {
	  font-family: "Inconsolata", monospace;
	  font-size: 14px;
    margin: auto;
}
pre {

            margin: 10px 10px 10px 10px;
            display: inline-block;
            vertical-align: top;
        text-align: left;
            /*background: rgba(255,255,255,0.3);*/
      }
ul {
  text-align:left;
  display: inline-block;
margin: 0 auto;
}
</style>
  </head>

	<body>

		<header>
			<h1>d3-composite-projections</h1>
			<h2>Set of d3 projections for showing countries' distant lands together</h2>
		</header>
    <section class="svg-section">
      <img id="france_example" src="./conicConformalFrance.svg" alt="France Conic Conformal"/>
    </section>
    <h2 class="subtitle">Drawing choropleth maps is difficult in some countries when parts of them are far away from the mainland</h2>

        <section class="github">
          <span>View on <a href="https://github.com/rveciana/d3-composite-projections">Github</a></span>
        </section>
			<section class="white-section">
				This library works with d3js v4. The old version worked with d3js v3, <a href="index_v3.html">check it here.</a>
			</section>
      <section class="light-section"><h2>Using the projection</h2>
      <h3>Use the composite projections as any other D3 projection. They are based in the included <a href="https://github.com/mbostock/d3/wiki/Geo-Projections#albersUsa">AlbersUsa</a>:</h3>
      <pre><code>var projection = d3.geo.conicConformalFrance();</code></pre>
      <h3>The following regions have available projections right now:</h3>
      <ul>
        <li>France: <a href="http://bl.ocks.org/rveciana/02eb5b83848e0b06fa8e">conicConformalFrance</a></li>
        <li>Portugal: <a href="http://bl.ocks.org/rveciana/aec08199d43759e98afe">conicConformalPortugal</a></li>
        <li>Spain: <a href="http://bl.ocks.org/rveciana/472b7749352554ca4b68">conicConformalSpain</a></li>
        <li>Europe: <a href="http://bl.ocks.org/rveciana/4bcc5750c776c22ffda6">conicConformalEurope</a></li>
        <li>Japan: <a href="http://bl.ocks.org/rveciana/72987a139a9886ed6a87">conicEquidistantJapan</a></li>
        <li>USA: <a href="http://bl.ocks.org/rveciana/170a76b8dc1f9cfd8b2d">albersUsa</a></li>
        <li>Ecuador: <a href="http://bl.ocks.org/rveciana/f00299fdacf079ecf3a60aca63eef66d">mercatorEcuador</a></li>
        <li>Chile: <a href="http://bl.ocks.org/rveciana/eaf7bce2b2cc8f90d2ac9142659962ed">transverseMercatorChile</a>, including the <a href="https://en.wikipedia.org/wiki/Chilean_Antarctic_Territory">Chilean Antarctic Territory</a></li>
        <li>Malaysia: <a href="http://bl.ocks.org/rveciana/6298dd3e71cf98b6930c06f19b6684a2">geoMercatorMalaysia</a>, created with the help of <a href="https://github.com/saifulazfar">Saiful Azfar Ramlee</a></li>
		<li>Equatorial Guinea: <a href="http://bl.ocks.org/rveciana/4dfc136b8e2707f182aa4591f892f82e">geoMercatorEquatorialGuinea</a></li>
        <li>United Kingdom: <a href="https://gist.github.com/rveciana/27272a581e975835aaa321ddf816d726">geoAlbersUk</a></li>
        <li>Denmark: <a href="https://observablehq.com/d/3a28765e735c5e67">geoTransverseMercatorDenmark</a></li>
	  </ul>
      </section>

      <section class="white-section">
        <h2>Adding the composite projection borders</h2>
        <h3>To draw the separation between projection regions, you can use <i>getCompositionBorders()</i>, which returns the calculated path:</h3>

          <pre><code>svg
  .append("path")
    .style("fill","none")
    .style("stroke","#000")
    .attr("d", projection.getCompositionBorders());</code></pre>

      </section>
      <section class="darker-section">
        <h2>Installation</h2>
        <h3>Getting the files</h3>
<div>You can get the files just by cloning the repository:</div>

  <pre><code>git clone https://github.com/rveciana/d3-composite-projections.git</code></pre>
<div>
or downloading the <i>composite-projections.js</i> or <i>composite-projections.min.js</i> files.<br/>

<h3>Using cdnjs</h3>
<div>You can link the files from your web page to <a href="https://cdnjs.com/libraries/d3-composite-projections">cdnjs</a>:</div>
<pre><code>&lt;script src="https://cdnjs.cloudflare.com/ajax/libs/d3-composite-projections/1.0.1/composite-projections.min.js"&gt;&lt;/script&gt;</code></pre>
<div>Or unpkg:</div>
<pre><code>&lt;script src="https://unpkg.com/d3-composite-projections@1.0.1"&gt;&lt;/script&gt;</code></pre>

<h3>Using NPM</h3>

<div>To install the projections with npm so you can run the tests, use it with node, etc, just run:</div>

<pre><code>npm install d3-composite-projections</code></pre>



      </section>
      <section class="white-section">
      <h2>Example</h2>
      <div id="example_map"></div>
      <h3><a href="http://bl.ocks.org/rveciana/0ff189b15449330828605fe4e118a716">Code using node:</a></h3>
      <pre><code>var d3_composite = require("d3-composite-projections");
var d3_geo = require("d3-geo");
var d3_request = require("d3-request");
var d3_selection = require("d3-selection");
var d3_transition = require("d3-transition");
var topojson = require("topojson");

var width = 960;
var height = 500;

var projection = d3_composite.geoConicConformalFrance();

var path = d3_geo.geoPath()
    .projection(projection);

var svg = d3_selection.select("#example_map").append("svg")
    .attr("width", width)
    .attr("height", height);

var t = d3_transition.transition()
  .on("interrupt", function(d,i){
    console.info(i);
  });

d3_request.json("france.json", function(error, topojsonData) {
    var us = topojson.feature(topojsonData, topojsonData.objects.regions);

    svg.selectAll(".region")
      .data(us.features)
      .enter()
      .append("path")
      .attr("d", path)
      .attr("class","region")
      .style("fill", "#aca")
      .style("stroke", "#000")
      .style("stroke-width", "0.5px")
      .on("mouseover", function(d,i) {
        d3_selection.select(this)
          .transition(t)
          .style("fill", "red");
        })
      .on("mouseout", function(d,i) {
        d3_selection.select(this).interrupt();
        d3_selection.select(this)
          .transition(t)
          .style("fill", "#aca");
        });

      svg
        .append("path")
          .style("fill","none")
          .style("stroke","#f00")
          .attr("d", projection.getCompositionBorders());

});
</code></pre>
<div>Create an index.html file:</div>
<pre><code>&lt;!DOCTYPE html&gt;
&lt;meta charset="utf-8"&gt;

&lt;body&gt;
&lt;div id="map"&gt;&lt;/div&gt;

&lt;script src="bundle.js"&gt;&lt;/script&gt;
</code></pre>
<div>Then, use browserify to use it from the browser:</div>
<pre><code>browserify draw.js > bundle.js</code></pre>

<h3><a href="http://bl.ocks.org/rveciana/bf9ff81544da5fe8ee54a2ba4ef45e9c">Code linking d3js directly:</a></h3>
<pre><code>var width = 960,
    height = 500;

var projection = d3.geoConicConformalFrance();
var path = d3.geoPath()
    .projection(projection);

var svg = d3.select("body").append("svg")
    .attr("width", width)
    .attr("height", height);

    var t = d3.transition();
d3.json("france.json", function(error, france) {
  var france = topojson.feature(france, france.objects.regions);
  svg.selectAll(".region")
      .data(france.features)
      .enter()
      .append("path")
      .attr("class", "region")
      .attr("d", path)
      .style("fill", "#aca")
      .style("stroke", "#000")
      .style("stroke-width", "0.5px")
      .on("mouseover", function(d,i) {
        d3.select(this).interrupt();
        d3.select(this)
          .transition(t)
          .style("fill", "red");
        })
      .on("mouseout", function(d,i) {
        d3.select(this).interrupt();
        d3.select(this)
          .transition(t)
          .style("fill", "#aca");
        });;

  svg
    .append("path")
      .style("fill","none")
      .style("stroke","#f00")
      .attr("d", projection.getCompositionBorders());

});</code></pre>

</section>

			<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-36383259-2', 'auto');
  ga('send', 'pageview');

</script>
<script src="bundle.js"></script>
  </body>


</html>
